<!DOCTYPE html>

<html>

	<head>
		<title>Map Chat</title>
		<script src="https://maps.google.com/maps/api/js?sensor=true"></script>
		<script>
			function mapinfo()
			{
				/*************** My Info ***************/
				var lat = 0;
				var lng = 0;

				if (navigator.geolocation)
				{
					console.log("fetching location...");
					navigator.geolocation.getCurrentPosition(function(position)
					{
						console.log("got location");
						lat = position.coords.latitude;
						lng = position.coords.longitude;
						console.log(lat);
						console.log(lng);
						post();
					});
				}
			
				else alert("Geolocation not supported -- try a different browser.");

				function post()
				{
					var xhr = new XMLHttpRequest();
					var url = "https://secret-about-box.herokuapp.com/sendLocation";
					var param = "login=GlendaSmith&lat=" + lat + "&lng=" + lng + "&message=holla"; 
					console.log(param);
	
					xhr.open("POST", url, true);
					xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
					xhr.setRequestHeader("Content-length", param.length);
					xhr.setRequestHeader("Connection", "close");
					xhr.onreadystatechange = function()
					{
						if (xhr.readyState == 4 && xhr.status == 200)
							console.log(xhr.responseText);
					}
					xhr.send(param);
				}
				/*************** Other Users ***************/

			}
		</script>
	</head>

	<body onload="mapinfo()">
	</body>

</html>